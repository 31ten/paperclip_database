class <%= migration_name %> < ActiveRecord::Migration
  def self.up
<%
  module_names = class_name.underscore.split('/')[0...-1]
-%>
<% attachments.each do |attachment| -%>
    create_table :<%= (module_names +[attachment.pluralize]).join("_") %> do |t|
      t.integer    :<%= name.underscore.camelize.tableize.tr('/', '_') %>_id
      t.string     :style
      t.binary     :file_contents
    end
  end
<% end -%>

  def self.down
<% attachments.each do |attachment| -%>
    drop_table :<%= (module_names +[attachment.pluralize]).join("_") %>
<% end -%>
  end
end
